<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPQ Calculator</title>
    <!-- Linking Plotly.js for graph plotting -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        #container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
        }
        #graph {
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div id="container">
    <h1>Economic Production Quantity (EPQ) Calculator</h1>
    <div id="inputForm">
        <label for="demand">Annual Quantity Demanded:</label>
        <input type="number" id="demand" min="1" required><br><br>
        <label for="productionCost">Cost of Production Run:</label>
        <input type="number" id="productionCost" min="1" required><br><br>
        <label for="holdingCost">Holding Cost per Unit:</label>
        <input type="number" id="holdingCost" min="1" required><br><br>
        <label for="productionRate">Production Rate:</label>
        <input type="number" id="productionRate" min="1" required><br><br>
        <button onclick="calculateEPQ()">Calculate</button>
    </div>
    <div id="graph"></div>
</div>

<script>
    function calculateEPQ() {
        var D = parseInt(document.getElementById("demand").value);
        var K = parseInt(document.getElementById("productionCost").value);
        var H = parseInt(document.getElementById("holdingCost").value);
        var P = parseInt(document.getElementById("productionRate").value);

        // Calculate EPQ
        var result = EPQ(D, P, K, H);

        // Plot graph
        var period = [];
        var inventory = [];

        for (var i = 0; i <= 12; i += 1.2) {
            period.push(i);
            period.push(i + 4.8);
        }

        for (var j = 0; j < period.length; j++) {
            inventory.push(80);
            inventory.push(0);
        }

        var trace1 = {
            x: period,
            y: inventory,
            type: 'scatter',
            mode: 'lines',
            name: 'Inventory Level'
        };

        var trace2 = {
            x: [0, 1.2],
            y: [0, 100],
            type: 'scatter',
            mode: 'lines',
            name: 'Production Rate',
            line: {dash: 'dash'}
        };

        var layout = {
            title: 'Economic Production Quantity',
            xaxis: {
                title: 'Month'
            },
            yaxis: {
                title: 'Inventory Level'
            }
        };

        var data = [trace1, trace2];

        Plotly.newPlot('graph', data, layout);
    }

    // Define EPQ function
    function EPQ(D, P, K, H) {
        if (D > 0 && P > 0 && K > 0 && H > 0) {
            var Q = Math.sqrt((2 * D * K) / (H * (1 - (D / P))));
            var T = Math.round((Q / D) * 12, 2);
            var number_of_production_runs = D / Q;
            var Tp = Math.round((Q / P) * 12, 2);
            var Td = Math.round((Q / D - Q / P) * 12, 2);
            var APC = number_of_production_runs * K;
            var AHC = (Q / 2) * (1 - D / P) * H;
            var Imax = Q * (1 - D / P);
            var ATC = APC + AHC;

            return [Q, T, number_of_production_runs, Tp, Td, APC, AHC, Imax, ATC];
        } else {
            console.error("Error. All function arguments must be non-negative.");
        }
    }
</script>
</body>
</html>
